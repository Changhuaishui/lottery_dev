# 项目中间件说明

## 项目环境
- 操作系统：CentOS 7
- 服务器IP：192.168.64.100
- 项目目录：/opt/lottery/deploy

## 中间件配置文件
项目使用docker-compose进行中间件管理，配置文件位于：
- docker-compose.yml：容器编排配置
- docker-compose-init.sql：MySQL初始化脚本

### 部署步骤

1. **准备工作**
```bash
# 创建项目目录
mkdir -p /opt/lottery
cd /opt/lottery

# 上传配置文件
# 将docker-compose.zip上传到/opt/lottery目录

# 解压配置文件
unzip docker-compose.zip
```

2. **配置说明**
```yaml
# docker-compose.yml 主要配置
services:
  # MySQL配置
  lottery-mysql:
    image: mysql:5.7.43
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: root
      
  # Redis配置
  lottery-redis:
    image: redis:6.0.6
    ports:
      - "6379:6379"
      
  # RabbitMQ配置
  lottery-rabbitmq:
    image: rabbitmq:3.6.10-management
    ports:
      - "5672:5672"
      - "15672:15672"
      
  # MinIO配置
  lottery-minio:
    image: minio/minio:RELEASE.2023-12-02T10-51-33Z
    ports:
      - "9005:9000"
      - "9006:9090"
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin
```

3. **启动服务**
```bash
cd /opt/lottery/deploy
docker compose up -d
```

## 中间件版本说明

### 1. MySQL
- 版本：5.7.43
- 端口：3306
- 账号：root/root
- 说明：项目使用5.7版本，保证兼容性

### 2. Redis
- 版本：6.0.6
- 端口：6379
- 说明：无密码模式，仅限内部访问

### 3. RabbitMQ
- 版本：3.6.10-management
- 服务端口：5672
- 管理端口：15672
- 账号：guest/guest
- 说明：包含管理界面插件

### 4. MinIO
- 版本：RELEASE.2023-12-02T10-51-33Z
- API端口：9005
- 控制台端口：9006
- 账号：minioadmin/minioadmin
- 说明：对象存储服务，用于文件管理

## 数据持久化
所有数据都保存在 `/opt/lottery/deploy` 目录下：
- MySQL数据：mysql-data/
- MinIO数据：minio-data/
- MinIO配置：minio-config/

## 注意事项
1. 所有中间件都是通过Docker容器方式部署
2. 配置文件已经过优化，无需额外配置
3. 首次启动会自动下载所需镜像
4. 建议使用Chrome浏览器访问管理界面
5. 数据目录已做好映射，数据安全有保障

## 版本兼容性
- MySQL 5.7.43：完全兼容项目需求
- Redis 6.0.6：满足缓存需求
- RabbitMQ 3.6.10：消息队列功能完整
- MinIO RELEASE.2023-12-02：对象存储功能正常

## 服务健康检查
```bash
# 检查所有容器状态
docker ps

# 检查容器日志
docker logs lottery-mysql
docker logs lottery-redis
docker logs lottery-rabbitmq
docker logs lottery-minio
```