# 后端服务启动调试记录

## 一、运行过程回顾

### 1. 初始环境配置
- Maven 环境：
  - Maven 3.6.3 安装在 `D:\maven` 目录
  - 本地仓库配置在 `D:\maven\repository`
  - 配置了阿里云镜像加速
  - 配置了 JDK 1.8 编译环境
- JDK 环境：
  - 项目开发 JDK：配置在 `D:\Program Files\Java\jdk-8`
  - 命令行 JDK：系统环境使用 JDK 23（不影响开发环境）

### 2. 项目结构
项目采用多模块结构：
- backend：后端管理服务
- frontend：前端业务服务
  - api：接口模块
  - msg：消息模块
  - commons：公共模块
- h5-vue：移动端界面

### 3. 启动尝试过程

#### 3.1 使用 Maven 直接启动（不推荐）
```bash
# 尝试1：直接使用 mvn spring-boot:run
mvn spring-boot:run  # 失败，因为 mvn 命令未被识别

# 尝试2：使用完整路径
D:\maven\bin\mvn spring-boot:run  # 成功执行但无详细日志输出
```

#### 3.2 使用 JAR 包启动（不推荐用于开发阶段）
```bash
# 构建 JAR 包
D:\maven\bin\mvn clean install -DskipTests

# 运行 JAR 包
java -jar target/backend-0.0.1-SNAPSHOT.jar
```

服务成功启动，监听在 8888 端口，可以通过 http://localhost:8888 访问登录页面。

## 二、遇到的问题及解决方案

### 1. Maven 命令识别问题
- 问题：mvn 命令无法识别
- 解决：使用完整路径 `D:\maven\bin\mvn`
- 建议：在 IntelliJ IDEA 中配置 Maven，避免命令行操作

### 2. 日志输出问题
- 问题：Maven 启动时没有详细日志
- 解决：
  1. 添加 -X 参数查看调试日志
  2. 使用 JAR 包启动可以看到完整日志

### 3. 开发阶段启动方式问题
- 问题：当前使用 JAR 包启动不适合开发阶段
- 建议启动方式：
  1. 使用 IntelliJ IDEA 直接运行主类
  2. 使用 IDE 的 Spring Boot 运行配置

## 三、IntelliJ IDEA 运行配置指南

### 1. 项目导入
1. 打开 IDEA，选择"Open"
2. 选择项目根目录 `D:\code\红包抽奖\代码包\lottery-dev`
3. 等待 Maven 依赖下载完成

### 2. Maven 配置
1. 打开 Settings (Ctrl + Alt + S)
2. 搜索 "Maven"
3. 配置 Maven home path: `D:\maven`
4. 配置 User settings file: `D:\maven\conf\settings.xml`
5. 配置 Local repository: `D:\maven\repository`

### 3. 运行配置
1. 找到主类 `com.ruoyi.RuoYiApplication`
2. 右键选择 "Run RuoYiApplication"
3. 编辑运行配置：
   - Working directory: `$PROJECT_DIR$/backend`
   - Active profiles: `druid`
   - JRE: 选择 JDK 1.8
   
### 4. 调试配置
1. 设置断点
2. 使用 Debug 模式运行
3. 可以在 Debug 窗口查看变量、调用栈等信息

## 四、开发建议

### 1. 避免使用 JAR 包运行
在开发阶段：
- 使用 IDE 直接运行更方便调试
- 代码修改后立即生效，无需重新打包
- 可以使用热部署提高开发效率

### 2. 使用 IDE 功能
- 断点调试
- 代码补全
- 实时错误提示
- Maven 依赖管理
- Git 版本控制

### 3. 开发环境统一
- 统一 JDK 版本（1.8）
- 统一 Maven 配置
- 统一代码风格
- 统一运行配置

## 五、注意事项
1. 确保数据库配置正确（MySQL 3306 端口）
2. 确保 Redis 配置正确
3. 确保 MinIO 配置正确
4. 首次运行前执行数据库初始化脚本 `prize_2024-01-03.sql`