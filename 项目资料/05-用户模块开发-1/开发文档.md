# 用户模块（难度：⭐️⭐️⭐️）

## 1、前置知识

**相关文档：《接口文档.xlsx》**



**用户基本设计：**

用户的密码为Md5密文存储，所以验证需要加密后再匹配数据库



**登录及注意事项：**

登录需要验证错误操作次数，超过5次后，冻结5分钟直接返回错误提示

可以借助redis实现



**密码安全性问题：**

用户信息请求接口返回的数据里，需要脱敏，去掉账户密码等敏感信息



**分布式环境下的session方案：**

项目已经集成spring redis session，登录成功后直接使用session来设置一个user属性，存储当前用户信息

后续的拦截将以session是否存在user作为是否登录的标记

```java
session.setAttribute("user",user);
```



**接口规范：**

所有接口返回json体必须是 com.itheima.prize.commons.utils.ApiResult

详细内容可以查看内部注释

接口详细内容参考**《接口文档.xlsx》**



**分页实现方案：**

Mybatis-Plus可以轻松实现分页

分页的返回数据使用PageBean对象来包装

一个参考案例如下：

```java
QueryWrapper<CardGame> gameQueryWrapper = new QueryWrapper<>();
Page<CardGame> page = gameService.page(new Page<>(curpage,limit),gameQueryWrapper);
return new ApiResult(1,"成功",new PageBean<CardGame>(page));
```



**便捷的查询：**

有些视图可能会帮到你

<img src="assets/image-20231123%E4%B8%8A%E5%8D%88113205404.png" alt="image-20231123上午113205404" style="zoom:80%;" />





## 2、任务清单

完成用户模块的代码编写

完成登录模块的代码编写



## 3、完成标准

提示：commons里的实体类可以作为data

### 3.1 实现LoginController里的代码

![image-20231122上午114555948](assets/image-20231122%E4%B8%8A%E5%8D%88114555948.png)



接口自测：【提交结果截图】

![image-20231122下午120054742](assets/image-20231122%E4%B8%8B%E5%8D%88120054742.png)

![image-20231122下午120125991](assets/image-20231122%E4%B8%8B%E5%8D%88120125991.png)

![image-20231122下午43209616](assets/image-20231122%E4%B8%8B%E5%8D%8843209616.png)

![image-20231122下午32753364](assets/image-20231122%E4%B8%8B%E5%8D%8832753364.png)



### 3.2 实现UserController里的代码

![image-20231122上午114432968](assets/image-20231122%E4%B8%8A%E5%8D%88114432968.png)



接口自测：【提交结果截图】

用户信息：直接从session获取user属性即可

![image-20231122下午45339345](assets/image-20231122%E4%B8%8B%E5%8D%8845339345.png)



参与的活动列表：【提交结果截图】

在完成活动抽奖接口之前，无数据，可以在card_user_hit中手工录入测试数据检验接口

查询结果可以使用视图：view_card_user_hit

![image-20231122下午52326794](assets/image-20231122%E4%B8%8B%E5%8D%8852326794.png)



### 3.3 前后联调

在前端页面实现登录、退出、个人中心展示 【提交结果截图】

![image-20231127下午21109886](pic//image-20231127%E4%B8%8B%E5%8D%8821109886.png)





